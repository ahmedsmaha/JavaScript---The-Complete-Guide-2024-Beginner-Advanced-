{"version":3,"file":"share-place.9c5d136ac77fc7d088d7.js","mappings":"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","sources":["webpack://my-place/./src/UI/Modal.js","webpack://my-place/./src/UI/Map.js","webpack://my-place/./src/SharePlace.js","webpack://my-place/./src/Utility/Location.js"],"sourcesContent":["export class Modal {\n  constructor(contentId, fallbackText) {\n    this.fallbackText = fallbackText;\n    this.contentTemplateEl = document.getElementById(contentId);\n    this.modalTemplateEl = document.getElementById('modal-template');\n  }\n\n  show() {\n    if ('content' in document.createElement('template')) {\n      const modalElements = document.importNode(\n        this.modalTemplateEl.content,\n        true\n      );\n      this.modalElement = modalElements.querySelector('.modal');\n      this.backdropElement = modalElements.querySelector('.backdrop');\n      const contentElement = document.importNode(\n        this.contentTemplateEl.content,\n        true\n      );\n\n      this.modalElement.appendChild(contentElement);\n\n      document.body.insertAdjacentElement('afterbegin', this.modalElement);\n      document.body.insertAdjacentElement('afterbegin', this.backdropElement);\n    } else {\n      // fallback code\n      alert(this.fallbackText);\n    }\n  }\n\n  hide() {\n    if (this.modalElement) {\n      document.body.removeChild(this.modalElement); // this.modalElement.remove()\n      document.body.removeChild(this.backdropElement);\n      this.modalElement = null;\n      this.backdropElement = null;\n    }\n  }\n}\n","export class Map {\n  constructor(coords) {\n    // this.coordinates = coords;\n    this.render(coords);\n  }\n\n  render(coordinates) {\n    if (!google) {\n      alert('Could not load maps library - please try again later!');\n      return;\n    }\n\n    const map = new google.maps.Map(document.getElementById('map'), {\n      center:coordinates,\n      zoom: 16\n    });\n\n    new google.maps.Marker({\n      position: coordinates,\n      map: map\n    });\n  }\n}\n","import { Modal } from './UI/Modal';\nimport { Map } from './UI/Map';\nimport { getCoordsFromAddress, getAddressFromCoords } from './Utility/Location';\n\nclass PlaceFinder {\n  constructor() {\n    const addressForm = document.querySelector('form');\n    const locateUserBtn = document.getElementById('locate-btn');\n    this.shareBtn = document.getElementById('share-btn');\n\n    locateUserBtn.addEventListener('click', this.locateUserHandler.bind(this));\n    this.shareBtn.addEventListener('click', this.sharePlaceHandler);\n    addressForm.addEventListener('submit', this.findAddressHandler.bind(this));\n  }\n\n  sharePlaceHandler() {\n    const sharedLinkInputElement = document.getElementById('share-link');\n    if (!navigator.clipboard) {\n      sharedLinkInputElement.select();\n      return;\n    }\n\n    navigator.clipboard.writeText(sharedLinkInputElement.value)\n      .then(() => {\n        alert('Copied into clipboard!');\n      })\n      .catch(err => {\n        console.log(err);\n        sharedLinkInputElement.select();\n      });\n  }\n\n  selectPlace(coordinates, address) {\n    if (this.map) {\n      this.map.render(coordinates);\n    } else {\n      this.map = new Map(coordinates);\n    }\n    this.shareBtn.disabled = false;\n    const sharedLinkInputElement = document.getElementById('share-link');\n    sharedLinkInputElement.value = `${location.origin}/my-place?address=${encodeURI(address)}&lat=${coordinates.lat}&lng=${coordinates.lng}`;\n  }\n\n  locateUserHandler() {\n    if (!navigator.geolocation) {\n      alert(\n        'Location feature is not available in your browser - please use a more modern browser or manually enter an address.'\n      );\n      return;\n    }\n    const modal = new Modal(\n      'loading-modal-content',\n      'Loading location - please wait!'\n    );\n    modal.show();\n    navigator.geolocation.getCurrentPosition(\n      async successResult => {\n        const coordinates = {\n          lat: successResult.coords.latitude + Math.random() * 50,\n          lng: successResult.coords.longitude + Math.random() * 50\n        };\n        const address = await getAddressFromCoords(coordinates);\n        modal.hide();\n        this.selectPlace(coordinates, address);\n      },\n      error => {\n        modal.hide();\n        alert(\n          'Could not locate you unfortunately. Please enter an address manually!'\n        );\n      }\n    );\n  }\n\n  async findAddressHandler(event) {\n    event.preventDefault();\n    const address = event.target.querySelector('input').value;\n    if (!address || address.trim().length === 0) {\n      alert('Invalid address entered - please try again!');\n      return;\n    }\n    const modal = new Modal(\n      'loading-modal-content',\n      'Loading location - please wait!'\n    );\n    modal.show();\n    try {\n      const coordinates = await getCoordsFromAddress(address);\n      this.selectPlace(coordinates, address);\n    } catch (err) {\n      alert(err.message);\n    }\n    modal.hide();\n  }\n}\n\nconst placeFinder = new PlaceFinder();\n","const GOOGLE_API_KEY = \"\";\n\nexport async function getAddressFromCoords(coords) {\n  const response = await fetch(\n    `https://maps.googleapis.com/maps/api/geocode/json?latlng=${coords.lat},${coords.lng}&key=${GOOGLE_API_KEY}`\n  );\n  if (!response.ok) {\n    throw new Error(\"Failed to fetch address. Please try again!\");\n  }\n  const data = await response.json();\n  if (data.error_message) {\n    throw new Error(data.error_message);\n  }\n  const address = data.results[0].formatted_address;\n  return address;\n}\n\nexport async function getCoordsFromAddress(address) {\n  const urlAddress = encodeURI(address);\n  const response = await fetch(\n    `https://maps.googleapis.com/maps/api/geocode/json?address=${urlAddress}&key=${GOOGLE_API_KEY}`\n  );\n  if (!response.ok) {\n    throw new Error(\"Failed to fetch coordinates. Please try again!\");\n  }\n  const data = await response.json();\n  if (data.error_message) {\n    throw new Error(data.error_message);\n  }\n\n  const coordinates = data.results[0].geometry.location;\n  return coordinates;\n}\n"],"names":["Modal","constructor","contentId","fallbackText","this","contentTemplateEl","document","getElementById","modalTemplateEl","show","createElement","modalElements","importNode","content","modalElement","querySelector","backdropElement","contentElement","appendChild","body","insertAdjacentElement","alert","hide","removeChild","Map","coords","render","coordinates","google","map","maps","center","zoom","Marker","position","addressForm","locateUserBtn","shareBtn","addEventListener","locateUserHandler","bind","sharePlaceHandler","findAddressHandler","sharedLinkInputElement","navigator","clipboard","writeText","value","then","catch","err","console","log","select","selectPlace","address","disabled","location","origin","encodeURI","lat","lng","geolocation","modal","getCurrentPosition","async","successResult","latitude","Math","random","longitude","response","fetch","ok","Error","data","json","error_message","results","formatted_address","getAddressFromCoords","error","event","preventDefault","target","trim","length","urlAddress","geometry","getCoordsFromAddress","message"],"sourceRoot":""}